

[toc]

## Entry Points

在 webpack 配置中， 有多种方式去定义 `entry` 属性。 



### **单入口（简写）语法 （# Single Entry (Shorthand) Syntax）**

Usage: `entry: string | [string]`

**webpack.config.js**

```javascript
module.exports = {
    entry: './path/to/my/entry/file.js',
}
```

这是以下配置的 shorthand(#简写) ：

**webpack.config.js**

```javascript
module.exports = {
    entry: {
        main: './path/to/my/entry/file.js',
    },
}
```

我们也可以传入一个文件路径的数组， 用于指定多个入口文件。 

当你想要把多个依赖文件注入到一起，并构建他们的依赖图到一个 “chunk” 的时候，会很有用。 

**webpack.config.js**

```javascript
module.export = {
    entry: ['./src/file_1.js','./src/file_2.js'],
    output: {
        filename: 'bundle.js',
    }
}
```

单入口语法方便快捷，但是在扩展配置的时候，不够灵活。 



### **对象语法 (# Object Syntax)**

Usage : `entry: { <entryChunkName> string | [string] } | {}`

**webpack.config.js**

```javascript
module.exports = {
    entry: {
        app: './src/index.js',// 将会导出名为 app.js 的文件
        adminApp: './src/adminApp.js', // 将会导出名为 adminApp.js 的文件
    }
}
```

对象语法更加的冗长，但是它是定义 entry/entries 扩展性最强的一种写法。

> Tip
>
> **"Scalable webpack configurations"** are ones that can be reused and combined with other partial configurations. This is a popular technique used to separate concerns by environment, build target, and runtime. They are then merged using specialized tools like [webpack-merge](https://github.com/survivejs/webpack-merge).

>Tip
>
>You can pass empty object `{}` to `entry` when you have only entry points generated by plugins.





### **入口描述对象（#EntryDescription object）**

一个用于描述入口文件的对象， 你可以指定以下属性：

- `dependOn`: 当前入口 (#entry point )所依赖的其他入口(entry points)。 他们必须在当前入口加载之前加载。 
- `filename`: 指定要输出的文件名称
- `import` : 启动时需加载的模块
- `library` : 指定 `library` 选项，为当前entry 构建一个 `library` 
- `runtime` ： 运行时 chunk 的名字。 如果设置了， 就会创建一个新的运行时 chunk 。 在 webpack 5.43.0 之后，可以将其设定为 `false` 以避免一个新的运行时 chunk
- `publicPath` ： 当该入口的输出文件在浏览器中被引用时，为他们指定一个公共 URL 地址。 请查看 [output.publicPath](https://webpack.docschina.org/configuration/output/#outputpublicpath)。

**webpack.config.js**

```javascript
module.exports = {
    entry: {
        a2: 'dependingfile.js',
        b2: {
            dependOn: 'a2',
            import: './src/app.js'
        }
    }
}
```

`runtime` 和 `dependOn` **不应在同一个入口上同时使用**，所以如下配置无效，并且会抛出错误：

> @jayce:
>
> 这里的意思时，配置多入口，且入口文件之间有依赖关系。 上例中，即 别名文件 “./src/app.js” 为 “b2”, 并且该文件依赖于 “dependingfile.js”, (别名为 “a2”)
>
> 这时候针对多入口的配置，output 可以这样去指定：
> ```javascript
>   output: {
>     path: path.resolve(__dirname, "dist"),
>     filename: "output_[name].js",
>   },
> ```
>
> 将会打包出 ： output_app.js , output_utils.js 
>
> 如果你要将多个入口文件，打包成一个文件：
> ```javascript
> const path = require('path');
> 
> module.exports = {
>     entry: './path/to/my/entry/file.js',
>     output: {
>         path: path.resolve(__dirname, 'dist'),
>         filename: 'my-first-webpack.bundle.js',
>     },
> }
> ```
>
> 









**webpack.config.js**

```javascript
module.exports = {
    entry: {
        a2: './a',
        b2: {
            runtime: 'x2',
            dependOn: 'a2',
            import: './b'
        }
    }
}
```

确保 `runtime` **不能指向已存在的入口名称**， 例如下面配置会抛出一个错误：
```javascript
module.exports = {
    entry: {
        a1: './a',
        b1: {
            runtime: 'a1',
            import: './b',
        }
    }
}
```

另外 `dependOn` 不能是循环引用的， 下面的例子也会抛出错误：

```javascript
module.exports = {
    entry: {
        a3: {
            import: './a,
            dependOn: 'b3',
        },
        b3: {
            import : './b',
            dependOn: 'a3'
        }
    }
}
```

> 多入口时，output 如何配置，请查看 [output](https://webpack.js.org/concepts/output/#multiple-entry-points) 章节
